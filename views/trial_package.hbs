<!---Nav-Bar----->
<div>
    <nav class="navbar navbar-expand-lg navbar-dark navbar-custom w3-padding-large">
    <a class="navbar-brand" href="/"><img src="yogarogya_log.png" alt=""></a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
  </nav>
</div>
<!---------------------------------Main Page-------------------------------------->
  <!-----Modal Button on top of Image------->
  <div style="background-color: #f7605e;">
    <div class="container con">   
      <div class="row">
        <div class="col-lg-12">
            <img src="img/hero-slider/1.png">
      <button type="button" class="btn btn-primary btn-xlg" data-toggle="modal" data-target="#myModal" style="font-family: 'Tenor Sans', sans-serif;">
        <b>Book Trial Package</b>
      </button>
        </div>
      </div>
    </div>
  </div>  
    <!--------------------Everything Inside Modal---------------------->
    <div class="modal fade" id="myModal">
      <div class="modal-dialog modal-xlg" style="width:100%;height:1200px !important;">
        <div class="modal-content" style="height: 100%;">
          <!------------------------Form---------------------------->
          <!--Form is filled with slides-------------------->
          <form  id="regForm" action="/student/login" method = "POST" style="font-family: 'Tenor Sans', sans-serif;">
              <!----------------------1) Register Slide------------------>
              {{>trial_packages_tabs/register_tab}}
            <!--------------------------2 Choose your mode tab---------->
              {{>trial_packages_tabs/mode_tab}}    
              <!------------------3 Gender Input tab------------->
              {{>trial_packages_tabs/gender_tab}}
                <!--------------------4 Program tab------------------------------->
              {{>trial_packages_tabs/program_tab}}
                <!---------------5 Partner tab---------------------->
              {{>trial_packages_tabs/partner_tab}}
               <!-----------------------------------6 Times tab----------------------->
              {{>trial_packages_tabs/times_tab}}
              <!---------------7 Pick time slot tab---------------------->
              {{>trial_packages_tabs/timeSlot_tab}}
              <div style="overflow:auto;">
                <div >
                  <button  class="site-btn sb-gradient mr-2" style="float:right;"type="button" id="nextBtn" onclick="nextPrev(1)">Next
                     <i class="fas fa-arrow-right"></i>
                  </button>
                  <button  class="site-btn sb-gradient ml-2" type="button"style="float:left;" id="prevBtn" onclick="nextPrev(-1)"> 
                    <i class="fas fa-arrow-left"></i> Prev
                   </button>
                </div>
              </div>                  
          </form>
        </div>
      </div>    
    </div>



<script>
         $(window).on('load',function(){
          $('#myModal').modal('show');
          });
        var currentTab = 0; // Current tab is set to be the first tab (0)
        showTab(currentTab); // Display the current tab

        // function for showing tab
        function showTab(n) {
            // This function will display the specified tab of the form...
            var x = document.getElementsByClassName("tab");
            x[n].style.display = "block";
            //... and fix the Previous/Next buttons:
            if (n == 0) {
                // do not display previous button if the tab_no. is 0
                document.getElementById("prevBtn").style.display = "none";
            } else {
                document.getElementById("prevBtn").style.display = "inline";
            }
            if (n == (x.length - 1)) {
                document.getElementById("nextBtn").innerHTML = "Submit";
            } 
        }

        // moving fieldset forward or backward    
        function nextPrev(n) {
            // This function will figure out which tab to display
            var x = document.getElementsByClassName("tab");
            // Exit the function if any field in the current tab is invalid:     
            // Hide the current tab:
            x[currentTab].style.display = "none";
            if (validateForm(n) && n >=0)
                currentTab = currentTab + n; 
            if (n < 0)
               currentTab = currentTab + n;           
            // if you have reached the end of the form...
            if (currentTab >= x.length) {
                // ... the form gets submitted:
                document.getElementById("regForm").submit();
                return false;
            }
            // Otherwise, display the correct tab:
            showTab(currentTab);
        }


        // function for checking if the form is clicked
        function validateForm(n){
            var x = document.getElementsByClassName("tab");
            var y = x[currentTab].getElementsByTagName("input");
            var d;
            var pers_info = [];
            try {
                 // check for form
                if (currentTab == 0 && n >=0){
                     for (i = 0; i < y.length; i++) {
                    // If a field is empty...
                    if (y[i].value == "") {
                         alert("please select one of the option");
                         return false; 
                     }
                     if (y[2].value.length <= 6){
                       alert("password should be strong!");
                       return false;
                     }
                     if (y[3].value.length <= 10){
                       alert("Enter valid phone number!");
                       return false;
                     }
                     pers_info.push(y[i].value);
                }
                }
                if (currentTab == 1 && n >=0)
                    d = document.querySelector('input[name="method"]:checked').value;
                if (currentTab == 2 && n >=0)
                    d = document.querySelector('input[name="gender"]:checked').value;
                if (currentTab == 3 && n >=0)
                    d = document.querySelector('input[name="program"]:checked').value;
                if (currentTab == 4 && n >=0)
                    d = document.querySelector('input[name="partner"]:checked').value;  
                if (currentTab == 5 && n >=0)
                    d = document.querySelector('input[name="time"]:checked').value;  
                if (currentTab == 6 && n >=0){
                    d1 = document.querySelector('input[name="timeSlot"]:checked').value;  
                    d2 = document.querySelector('input[name="timeSlot1"]:checked').value; 
                }
              }    
            catch(e){
                alert("please select one of the option");
                return false;
            }
            if (currentTab == 0)
                makeAjaxCall1(pers_info);
            else if (currentTab !=6 && currentTab!=0) {
              makeAjaxCall2(d);
            }
            else{
              makeAjaxCall3(d1,d2);
            }  
            return true;
        } 
           
            function makeAjaxCall1(pers_info){   
              $.ajax({
                  type:'POST',
                  url: '/trial_package/book_trial',
                  data :{'name':pers_info[0],'email':pers_info[1],'password':pers_info[2],'phone':pers_info[3]},
                  dataType: 'json',
                  success : function(data){
                      console.log('success');
                  }
                });
            } 
            function makeAjaxCall2(d){   
              $.ajax({
                type:'POST',
                url: '/trial_package/book_trial',
                data :{'d':d},
                dataType: 'json',
                success : function(data){
                    console.log('success');
                }
              });
            }  
            function makeAjaxCall3(d1,d2){   
              $.ajax({
                type:'POST',
                url: '/trial_package/book_trial',
                data :{'d1':d1 , 'd2':d2},
                dataType: 'json',
                success : function(data){
                    console.log('success');
                }
              });
            }

        // for finding day of the week
        function DayTime(){
            var days = ["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];
            
            var date = new Date();
            console.log(date);
            document.getElementById("tommorrow").innerHTML = date.getDate()+1;
            document.getElementById("dateAfter").innerHTML = date.getDate()+2;
            document.getElementById("dateAfter1").innerHTML = date.getDate()+3; 
            document.getElementById("dayAfter").innerHTML = days[(date.getDay()+1)%7];
            document.getElementById("dayAfter1").innerHTML = days[(date.getDay()+2)%7];
            console.log(days[date.getDay()+2]);
        }
</script>
 